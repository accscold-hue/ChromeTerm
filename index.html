<!DOCTYPE html>
<html>
<head>
  <title>Fake Terminal</title>
  <style>
    body {
      background-color: black;
      color: #00ff00;
      font-family: monospace;
      font-size: 16px;
      padding: 20px;
    }
    .terminal {
      max-width: 800px;
      white-space: pre-wrap;
    }
    input {
      background: black;
      color: #00ff00;
      border: none;
      outline: none;
      font-family: monospace;
      font-size: 16px;
      width: 90%;
    }
    .cursor {
      display: inline-block;
      width: 10px;
      background-color: #00ff00;
      animation: blink 1s steps(2, start) infinite;
    }
    @keyframes blink {
      to { visibility: hidden; }
    }
  </style>
</head>
<body>
  <div class="terminal" id="terminal">
    <pre>
   _  
  | | 
/ __)
\__ \
(   /
 |_| 
    </pre>
    <div>Type <b>help</b> to see commands.</div>
    <br>
  </div>

<script>
const terminal = document.getElementById("terminal");

// ----- Fake filesystem -----
let filesystem = {
  "/": ["home", "var", "etc", "readme.txt"],
  "/home": ["user", "notes.txt"],
  "/home/user": ["secret.txt", "todo.txt"]
};
let currentPath = "/";

// ----- Command history -----
let history = [];
let historyIndex = -1;

// ----- Create input line -----
const inputLine = document.createElement("div");
inputLine.innerHTML = "~$ <input id='command' autofocus>";
terminal.appendChild(inputLine);
const input = inputLine.querySelector("input");

// ----- Helper functions -----
function print(text, delay = 0) {
  if(delay === 0){
    const div = document.createElement("div");
    div.textContent = text;
    terminal.insertBefore(div, inputLine);
  } else {
    let i = 0;
    const div = document.createElement("div");
    terminal.insertBefore(div, inputLine);
    const interval = setInterval(() => {
      div.textContent += text[i];
      i++;
      if(i >= text.length) clearInterval(interval);
    }, delay);
  }
}

function showPrompt() {
  input.focus();
}

// ----- Handle commands -----
input.addEventListener("keydown", async function(e) {
  if(e.key === "ArrowUp"){
    if(history.length > 0){
      historyIndex = (historyIndex <= 0) ? 0 : historyIndex -1;
      input.value = history[historyIndex];
    }
    e.preventDefault();
    return;
  }
  if(e.key === "ArrowDown"){
    if(history.length > 0){
      historyIndex = (historyIndex >= history.length-1) ? history.length-1 : historyIndex +1;
      input.value = history[historyIndex];
    }
    e.preventDefault();
    return;
  }
  if(e.key !== "Enter") return;

  const cmdLine = input.value.trim();
  if(!cmdLine) return;

  print("~$ " + cmdLine);
  history.push(cmdLine);
  historyIndex = history.length;
  input.value = "";

  const parts = cmdLine.split(" ");
  const cmd = parts[0].toLowerCase();
  const args = parts.slice(1);

  switch(cmd){
    case "help":
      print("Available commands:");
      print(" help    - show this message");
      print(" ping    - test GET request");
      print(" clear   - clear terminal");
      print(" whoami  - show username");
      print(" echo    - print text");
      print(" ls      - list files");
      print(" cd      - change folder");
      break;

    case "ping":
      print("Pinging server...");
      try{
        const res = await fetch("https://api.github.com/zen");
        const text = await res.text();
        print("Reply: " + text);
      }catch{
        print("Ping failed.");
      }
      break;

    case "clear":
      terminal.innerHTML = "";
      const pre = document.createElement("pre");
      pre.textContent = `
 _  
| | 
/ __)
\\__ \\
(   /
 |_| 
      `;
      terminal.appendChild(pre);
      break;

    case "whoami":
      print("user123");
      break;

    case "echo":
      print(args.join(" "));
      break;

    case "ls":
      const folder = filesystem[currentPath] || [];
      print(folder.join("  "));
      break;

    case "cd":
      if(args.length === 0){
        print("cd: missing folder");
      } else {
        const target = args[0];
        let newPath;
        if(target === ".."){
          if(currentPath !== "/"){
            const parts = currentPath.split("/").filter(p => p);
            parts.pop();
            newPath = "/" + parts.join("/");
            if(newPath === "") newPath = "/";
            currentPath = newPath;
          }
        } else if(filesystem[currentPath] && filesystem[currentPath].includes(target)){
          if(currentPath === "/") newPath = "/" + target;
          else newPath = currentPath + "/" + target;
          if(filesystem[newPath]){
            currentPath = newPath;
          } else {
            print("cd: not a folder");
          }
        } else {
          print("cd: folder not found");
        }
      }
      break;

    default:
      print(`Command not found: ${cmd}`);
  }

  showPrompt();
});
</script>
</body>
</html>
